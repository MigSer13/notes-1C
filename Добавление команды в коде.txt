&После("ДобавитьКомандыПечати")
Процедура цка_ДобавитьКомандыПечати(КомандыПечати)
	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.Обработчик = "цка_ОбщиеПроцедурыКлиент.ВыполнитьКомандуПечати";
	КомандаПечати.МенеджерПечати = "Документ.ПриемНаРаботу";
	КомандаПечати.Идентификатор = "цка_СогласиеНаОбработкуПерсональныхДанных";
	КомандаПечати.Порядок = 80;
	КомандаПечати.Представление = НСтр("ru = 'Согласие на обработку персональных данных'");
	КомандаПечати.ПроверкаПроведенияПередПечатью = Истина;
КонецПроцедуры


//Общий модуль
&НаКлиенте
Функция ВыполнитьКомандуПечати(ОписаниеКоманды) Экспорт
		
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.Защита = Ложь;
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.ОтображатьЗаголовки = Ложь;
	//ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ТабДок.Автомасштаб = Истина;

	Если ОписаниеКоманды.Идентификатор = "цка_СогласиеНаОбработкуПерсональныхДанных" Тогда
		цка_ОбщиеПроцедурыСервер.ПечатьСогласиеНаОбработкуПерсДанныхСервер(ОписаниеКоманды.ОбъектыПечати, ТабДок, ОписаниеКоманды.МенеджерПечати);	
		ТабДок.Показать("ПЕЧАТЬ: Согласие на обработку персональных данных.");
		Возврат ТабДок;
	ИначеЕсли ОписаниеКоманды.Идентификатор = "цка_ДоговорОМатериальнойОтветственности" Тогда	
		цка_ОбщиеПроцедурыСервер.ПечатьДоговорОМатериальнойОтветственностиСервер(ОписаниеКоманды.ОбъектыПечати, ТабДок, ОписаниеКоманды.МенеджерПечати);
		ТабДок.Показать("ПЕЧАТЬ: Договор о материальной ответственности.");
		Возврат ТабДок;
	ИначеЕсли ОписаниеКоманды.Идентификатор = "цка_ОбязательствоОНеразглашенииКомТайны" Тогда	
		цка_ОбщиеПроцедурыСервер.ПечатьОбязательствоОНеразглашенииКомТайныСервер(ОписаниеКоманды.ОбъектыПечати, ТабДок, ОписаниеКоманды.МенеджерПечати);
		ТабДок.Показать("ПЕЧАТЬ: Обязательство о неразглашении ком. тайны.");	
		Возврат ТабДок;
	ИначеЕсли ОписаниеКоманды.Идентификатор = "цка_ТрудовойДоговор" Тогда
		КнопкиДляВопроса = цка_ОбщиеПроцедурыСервер.ПолучитьДопПараметрПоОрганизации(ОписаниеКоманды.ОбъектыПечати);			
		Если КнопкиДляВопроса = Неопределено Тогда
			Возврат Неопределено;			
		ИначеЕсли КнопкиДляВопроса.Количество()<>0 Тогда     //выбран трудовой договор Грейнрус
			Параметры = Новый Структура;
			Параметры.Вставить("ТабДок", ТабДок);
			Параметры.Вставить("МенеджерПечати", ОписаниеКоманды.МенеджерПечати);
			Параметры.Вставить("МассивОбъектов", ОписаниеКоманды.ОбъектыПечати);
			ПоказатьВопрос(Новый ОписаниеОповещения("ЗадатьВопрос", цка_ОбщиеПроцедурыКлиент, Параметры), 
							"Выберите руководителя в качестве работодателя:", КнопкиДляВопроса);
		Иначе	
			цка_ОбщиеПроцедурыСервер.ПечатьТрудовогоДоговораСервер(ОписаниеКоманды.ОбъектыПечати, ТабДок,  ОписаниеКоманды.МенеджерПечати);
			ТабДок.Показать("ПЕЧАТЬ: Трудовой договор.");	
			Возврат ТабДок; 
		КонецЕсли; 
	ИначеЕсли ОписаниеКоманды.Идентификатор = "цка_ПриказНаОтпускССохранениемОплаты_Т6" Тогда	
		цка_ОбщиеПроцедурыСервер.ПечатьПриказаНаОтпускССохранениемОплатыСервер(ОписаниеКоманды.ОбъектыПечати, ТабДок, ОписаниеКоманды.МенеджерПечати);
		ТабДок.Показать("ПЕЧАТЬ: Приказ отпуска с сохранением оплаты");	
		Возврат ТабДок;	
	КонецЕсли; 	 
КонецФункции
